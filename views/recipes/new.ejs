<% if (recipeData.reviews.length) { %>
    <table>
        <thead>
            <tr>
                <th>User</th>
                <th>Date</th>
                <th>Review</th>
                <th>Rating</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <% let total=0 %>
                <% recipeData.reviews.forEach(function(r) { %>
                    <% total +=r.rating %>
                        <tr>
                            <td class="review-user"><img alt="avatar" src="<%= r.userAvatar%>"
                                    referrerpolicy="no-referrer">
                                <%= r.userName%>
                            </td>
                            <td><%= r.createdAt.toLocaleDateString() %></td>
                            <td><%= r.content %></td>
                            <td><%= r.rating %></td>
                            <td>
                                <% if (user?._id.equals(r.user)) { %>
                                    <form action="/reviews/<%= r._id%>?_method=DELETE" method="POST">
                                        <button type="submit">X</button>
                                    </form>
                                    <% } %>
                            </td>
                        </tr>
                        <% }); %>
                            <tr>
                                <td colspan="2"></td>
                                <td><strong><%= (total / recipeData.reviews.length).toFixed(1) %></strong></td>
                            </tr>
        </tbody>
    </table>
    <% } else { %>
        <h5>No Reviews Yet</h5>
        <% } %>
